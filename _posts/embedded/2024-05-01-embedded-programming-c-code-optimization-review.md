---
title: "[embedded] 임베디드 프로그래밍 C코드 최적화 chapter 2 리뷰"
excerpt: "임베디드 프로그래밍 C코드 최적화 리뷰"

categories: 
  - embedded
tags:
  - [embedded, C]

toc: true
toc_sticky: true
date: 2024-05-01
last_modified_at: 2024-05-01
---

"본 글은 한빛미디어의 임베디드 프로그래밍 C코드 최적화 책을 읽고 요약한 내용입니다."

chapter 2는 크게 두 가지 내용을 담고 있습니다.

[1. 하드웨어 접근](#1-하드웨어-접근-및-제어)  
[2. 비트 연산](#2-비트-연산)  

##### 1. 하드웨어 접근 및 제어

소프트웨어에서 하드웨어는 메모리로 인식된다. 마이크로프로세서에서는 프로그램을 동작시키기 위해 입출력 포트에서 사용할 메모리를 지정하고, 지정된 메모리에 입출력 포트의 설정 값과 데이터, 하드웨어 제어 값을 써서 제어한다.  

하드웨어 제어는 일반적으로 사용할 포트를 어떤 모드를 사용할 지 설정하고, 프로그램에서 데이터 레지스터에 값을 쓰거나 읽는 방식이다. 데이터 시트는 이러한 접근을 위해 보드를 구성하는 하드웨어와 마이크로프로세서를 제어하는 정보를 제공한다.  

하드웨어 접근 시 하드웨어에서 사용하는 메모리를 선언해 메모리에 접근한다.
```c
char *p = (char *) 0x30000000;
```

##### 2. 비트 연산

장치의 레지스터 접근시 사용하는 메모리, 즉 특정 비트만을 제어해야 한다. 다른 장치가 사용하는 비트까지 변경할 경우 오작동의 위험이 있다. 따라서 레지스터의 특정 비트 제어를 위해 비트 연산을 사용한다.

1) 특정 비트 설정 및 클리어
```c
a |= 0x1<<5;     // 5번 비트를 1로 설정
a &= ~(0x1<<2);  // 2번 비트를 0으로 클리어
```
2) 특정 비트 반전
```c
a ^= 0x1<<5;    // 5번 비트를 반전  
```
3) 비트 검사
```c
a & (0x1<<5)    // 5번 비트가 0인지 1인지 검사
```

이러한 수식을 주로 매크로 함수로 만들어 사용한다. 이 외에도 비트 연산을 활용하여 복잡한 로직을 비교적 짧은 코드로 구현할 수 있다.